# 1. 브라우저 주소창에 https://www.naver.com/ 를 입력하여 일어나는 과정과 렌더링 프로세스

[참고문서](!https://velog.io/@sylagape1231/%EC%A3%BC%EC%86%8C%EC%B0%BD%EC%97%90-naver.com%EC%9D%84-%EC%B9%98%EB%A9%B4-%EC%9D%BC%EC%96%B4%EB%82%98%EB%8A%94-%EC%9D%BC%EC%9D%84-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%B4%EB%B3%B4%EC%9E%90)

![](https://velog.velcdn.com/images/0seo8/post/8a9fa59f-b08c-4c9a-8b01-e182c858c2aa/image.png)

## 브라우저 주소창에 https://www.naver.com/ 를 입력하여 일어나는 과정

1. 주소창에 입력한 텍스트 정보를 확인
   텍스트가 검색어인지 URL인지 확인 (작업의 주체: 브라우저 엔진의 UI스레드)

- 텍스트가 검색어라면?
  - 브라우저는 검색엔진의 URL에 검색어를 포함한 주소로 페이지를 이동시킵니다.
- 텍스트가 URL이라면?
  - 브라우저 엔진에서(네트워크 스레드를 통해)네트워크 호출을 수행합니다.

2. 네트워크 호출

1) 네이버 서버의 주소 찾기

   - 네이버 서버의 주소를 찾기 위해 클라이언트(사용자의 컴퓨터는) 자신의 host파일에 도메인네임(naver.com)에 대응하는 IP주소(125.209.222.142)가 있는지 우선적으로 확인합니다.
   - 없다면, 네임서버(DNS서버)에 '네이버의 IP주소를 알려주세요'라는 요청을 보냅니다.

2) 네이버 서버와 통신하여 필요한 데이터 받기

- 알아낸 주소를 바탕으로 네이버 서버에 데이터를 요청하는 HTTP Requset를 보냅니다.
- HTTP Request를 받은 네이버 서버는 클라이언트가 요청한 문서를 찾아 읽고 이를 바이트 형태로 변환한후 클라이언트 HTTP Reply(HTTP response)를 보냅니다.

3. 렌더링 작업

- 브라우저 엔진은 네이버 서버로부터 응답 받은 데이터에 악성 바이러스가 없는지 우선 검사합니다.
- 브라우저 엔진은 렌더링 엔진에게 해당 데이터를 해석하고, 웹페이지에 띄울 것을 요청합니다.
- 요청을 받은 렌더링 엔진은 받은 데이터를 바탕으로 렌더링 프로세스를 수행하고, 이과정이 끝나면 브라우저 엔진에게 작업 완료를 알립니다.

## 렌더링 프로세스

1. HTML을 파싱하여 DOM 트리 구축, CSS를 파싱하여 CSSOM 트리 구축 (+ JS 파싱)
2. DOM 트리와 CSSOM 트리를 통해 랜더 트리 구축 (Attachment / 형상 구축)
3. 랜더 트리 배치 (Layout / Reflow)

- 전체적인 웹 페이지 화면 안에서 렌더 트리 내 각 노드의 위치, 크기 (너비와 높이) 를 계산하고, 이를 화면에 배치하는 레이아웃 (Layout) 과정이 진행

4. 랜더 트리 그리기 (Paint)

상세

- 서버로부터 응답 받은 바이트 형태의 HTML문서를, 지정된 인코딩방식에 따라 변환합니다.
- 이렇게 변환한 문자열을 토큰으로 분해합니다.
- 토큰의 내용에 따라 객체(노드)로 변환한 후 객체를 트리구조로 구성하여 DOM을 생성합니다.
- 만약, HTML을 파싱하던 중 link태그를 만나면 잠시 중단하고 CSSOM을 생성합니다.
- 마찬가지로 HTML을 파싱하던 중 script태그를 만나면 잠시 중단하고 서버에게 해당 javascript리소스를 브라우저 엔진으로부터 받아옵니다. 그리고 javascript엔진에게 제어건을 넘겨줍니다.
- javascript엔진은 받아온 JS리소스를 파싱하여 AST(추상구문트리)를 생성하고 이를 바이트 코드로 변환해 실행합니다.
- javascript파싱이 종료되면 렌더링 엔진은 다시 제어권을 돌려받고 DOM생성을 이어나갑니다.
- 만일 script 태그를 body 태그의 중간에 작성할 경우, HTML 파싱이 끝나지 않은 상태에서 JavaScript로 인해 DOM이 조작되어 에러가 발생할 위험이 생긴다.
- 따라서 script 태그는 반드시 body 태그 내부의 최하단에 위치하거나 script태그에 defer속성을 부여해주어야합니다.

---

# 브라우저 동작 원리를 간단하게 설명해주세요.

1️⃣ 브라우저 주소창에 www.google.com 을 입력합니다.
2️⃣ 해당하는 구글 서버를 찾아갑니다.
3️⃣ DNS 서버에서 도메인 네임과 매칭될 실서버(IP주소)를 찾게됩니다. (이때, https 방식을 체크합니다.)
4️⃣ 서버의 기본설정이 대부분 index.html이기 때문에 서버에 해당 파일을 클라이언트로 보냅니다.
5️⃣ 브라우저는 텍스트로 이루어진 index.html 파일을 파싱합니다.
6️⃣ 한줄씩 읽으며 DOM, CSSOM 트리를 만들어나갑니다. (Obejct Model 만들기)
7️⃣ `<link>` 태그를 만나 CSS 요청이 발생하면, 요청과 응답과정을 거치고 CSS를 파싱합니다.
8️⃣ CSS 파싱이 끝나면 중단된 index.html을 다시 읽고 DOM 트리를 완성합니다.
9️⃣ 완성된 DOM트리와 CSSOM트리를 합쳐서 Render Tree를 렌더링합니다.
🔟 JavaScript는 중간 과정에서 HTML 파서는 `<script>` 태그를 만나면 JavaScript 코드를 실행하기 위해 파싱을 중단합니다.
➡️ 제어권한을 자바스크립트 엔진에게 넘기고 자바스크립트 코드 또는 파일을 로딩해 파싱하고 실행합니다.
